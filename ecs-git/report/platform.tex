\section{Platform Parameter Design}
\label{sec:platform}

The microkernel slot size C, partition table size P and TDM table size in the control system design play a large role in task timing and scheduling. These parameters' units are shown in Table \ref{tab:design}. The mircokernel slot size will determine the the clock cycles (time) for which the microkernel needs to execute correctly, this was stated to be at least 40.96$\mu$s.

Thus the microkernel slot size could at best reach roughly 40 $\mu$s which would yield to about: $$ C_{min} = 100MHz \cdot 40.96 \mu s = 4096 \;\;Clock \; Cycles$$

This observation was small starting point of educated assumptions about which C and P to chose. Then it was decided rather than picking values for P and C separately to pick a fraction, relating those two. 

In Section \ref{sec:steps} the steps to the findings of sufficient values for P, C and TDM tabel size will be carried out. The goal is to meet the design constraints.

\subsection{Design and Workflow}
\label{sec:steps}
This subsection will discuss selection of P,C, Sensor to actuator delay and some choices considered for poles, TDM table size in order to meet the design constraints. To create an overview of how this was done, a timeline with the steps taken will be presented here.

\begin{enumerate}
	\item First tests made were rather basic and were used to determine the acuteness of poles on the system. A Matlab script was made to keep P=C,from 7000 up to 16000 clock cycles, and alternating the poles from 0.6 up to 0.9 with 0.1 as increment(keeping all poles at the same value). Along each test, settling time and validity of design constraints was included as output. Thus the valid parameter would render 0 or 1 depending on if all design constraints are met or not.
	
	To clarify all combinations of the following were tested, 40 in total:
	\begin{description}
		\item[P=C=] [7000:1000:16000]
		\item[Poles=] [0.6:0.1:0.9]$\cdot$[1 1 1 1 1]
		\item[TDM Table Size] = 4
	\end{description}
	When poles were at 0.6 and 0.7 there were very few valid options so these were excluded.
	
	\item Then ruling out poles at 0.6 and 0.7 and sticking to 0.8 and 0.8 where that gave more promising results. Then adding a fraction relation between C and P as shown here:
		\begin{description}
			\item[P=$\dfrac{C}{frac}$] where frac = [1:0.1:2]
			\item[Poles=] [0.8:0.1:0.9]$\cdot$[1 1 1 1 1]
			\item[TDM Table Size] = 4
		\end{description}
	This yielded \textbf{200 options} both valid and invalid counted.
	\item Now filter out only valid results, which meet the design constraints set such as settling time and current limitations (and a few more). This is yielded to \textbf{144 valid options}.
	\item Next calculate the Quality of Control for each of the valid options and chose the best ones. The best 
	\item
	\item
	\begin{table}[htbp]
		\centering
		\caption{}
		\begin{tabular}{lllccccc}
			\toprule
			Rank & C& P & Poles &Valid &OoC & R & $\dfrac{QoC}{R}$ [Cost Function] \\ 
		\midrule
		144 & 16000 & 8000 & 0.8 & 1 & 183.36 & 0.25 & 733.4 \\ 
		128 & 13000 & 10000 & 0.8 & 1 & 183.89 & 0.33 & 563.9 \\ 
		78 & 16000 & 8000 & 0.9 & 1 & 80.95 & 0.25 & 323.8 \\ 
	\midrule
	\end{tabular}
	\label{}
\end{table}

\end{enumerate}

\subsubsection{Sensor to actuator delay}
\label{sec:stad}

\subsection{Implementation of Design steps in Matlab}
\color{red}
Show matlab code for designing and explain matlab approach,
\color{black}